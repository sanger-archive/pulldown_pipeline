<h1>Plate: <i><%= @plate.barcode %></i></h1>
<%# Change State Options %>
<div id="plate-tabs" class="tabs">
  <ul>
    <li><a href="#plate-summary">Summary</a></li>
    <li><a href="#plate-printing">Printing</a></li>
    <li><a href="#plate-state">State</a></li>
  </ul>

  <article id="plate-summary">
    <h2>Summary</h2>
    <p><%= @plate.summary %></p>
    <p><%= @plate.notes %></p>
  </article>

  <article id="plate-state">
    <h2>Plate State</h2>
    <%= semantic_form_for(@plate, :url => plate_path(@plate.barcode), :html => {:method => :put}) do |f| %>
      <%= f.inputs :name => 'Set State' do %>
        <%= f.input :state, :label => 'Current State', :collection => @plate.states,:as => :select, :input_html => { :include_blank => false } %>
        <%= f.input :user %>
        <%= f.input :notes, :as => :text %>
        <%= f.commit_button 'Change State' %>

      <% end %>
    <%- end %>

    <%# Move this to the new method of creation controller %>
    <%- if @plate.state == "passed" && @plate.child_plate_purposes.size > 0 -%>
    <hr/>

        <%= form_tag new_plate_child_path(@plate.barcode), :method => 'get' do %>
          <p>
            <%= label_tag :plate_purpose_uuid, "Child Type" %>
            <%= select_tag :plate_purpose_uuid, 
              options_from_collection_for_select(@plate.child_plate_purposes, :name, :name)
            %>
          </p>
            <%= submit_tag "Next", :name => nil, :class => "submit" %>
        <% end %>
      

    <%- end -%>

  </article>

  <article id="plate-printing">
    <%= link_to "Download Worksheet" %> - <%= button_to "Print Worksheet", {}, {:class => "submit"} %>

    <hr/>
    <%= semantic_form_for(@barcode_label, :url => barcode_label_path(@barcode_label), :html => {:method => :put}) do |f| %>
      <%# There's a bug here somewhere in formtastic which means it's ignoring :input_options :(
          It looks like an previous bug so I really should open a ticket...
      %>
      <%= f.inputs :name => 'Print Barcode Labels' do %>
        <%= f.input :printer, :label => 'Barcode Printer', :input_html => { :prompt => "Please select a printer..." }, :collection => @printers %>
        <%= f.commit_button 'Print Label' %>
      <% end %>
    <% end %>
  </article>

</div>

